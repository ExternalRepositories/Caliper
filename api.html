<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Annotation API &mdash; Caliper 1.5.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Caliper 1.5.0 documentation" href="index.html" />
    <link rel="next" title="Linking Caliper programs" href="link.html" />
    <link rel="prev" title="Concepts" href="concepts.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="link.html" title="Linking Caliper programs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="concepts.html" title="Concepts"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Caliper 1.5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="annotation-api">
<h1>Annotation API<a class="headerlink" href="#annotation-api" title="Permalink to this headline">¶</a></h1>
<p>Caliper provides source-code instrumentation APIs for C and C++ to
create and access Caliper context attributes.</p>
<div class="section" id="constants-and-types">
<h2>Constants and types<a class="headerlink" href="#constants-and-types" title="Permalink to this headline">¶</a></h2>
<dl class="macro">
<dt id="c.CALI_INV_ID">
<code class="descname">CALI_INV_ID</code><a class="headerlink" href="#c.CALI_INV_ID" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates an invalid (attribute) ID value.</p>
</dd></dl>

<dl class="type">
<dt id="c.cali_attr_type">
<code class="descname">cali_attr_type</code><a class="headerlink" href="#c.cali_attr_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the datatype of attributes.</p>
<dl class="macro">
<dt id="c.CALI_TYPE_INV">
<code class="descname">CALI_TYPE_INV</code><a class="headerlink" href="#c.CALI_TYPE_INV" title="Permalink to this definition">¶</a></dt>
<dt id="c.type">
Indicates an undefined <code class="descname">type</code><a class="headerlink" href="#c.type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.CALI_TYPE_USR">
<code class="descname">CALI_TYPE_USR</code><a class="headerlink" href="#c.CALI_TYPE_USR" title="Permalink to this definition">¶</a></dt>
<dt id="c.type.">
A user-defined <code class="descname">type.</code><a class="headerlink" href="#c.type." title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.CALI_TYPE_INT">
<code class="descname">CALI_TYPE_INT</code><a class="headerlink" href="#c.CALI_TYPE_INT" title="Permalink to this definition">¶</a></dt>
<dt id="c.CALI_TYPE_UINT">
<code class="descname">CALI_TYPE_UINT</code><a class="headerlink" href="#c.CALI_TYPE_UINT" title="Permalink to this definition">¶</a></dt>
<dt id="c.CALI_TYPE_STRING">
<code class="descname">CALI_TYPE_STRING</code><a class="headerlink" href="#c.CALI_TYPE_STRING" title="Permalink to this definition">¶</a></dt>
<dt id="c.CALI_TYPE_ADDR">
<code class="descname">CALI_TYPE_ADDR</code><a class="headerlink" href="#c.CALI_TYPE_ADDR" title="Permalink to this definition">¶</a></dt>
<dt id="c.CALI_TYPE_DOUBLE">
<code class="descname">CALI_TYPE_DOUBLE</code><a class="headerlink" href="#c.CALI_TYPE_DOUBLE" title="Permalink to this definition">¶</a></dt>
<dt id="c.CALI_TYPE_BOOL">
<code class="descname">CALI_TYPE_BOOL</code><a class="headerlink" href="#c.CALI_TYPE_BOOL" title="Permalink to this definition">¶</a></dt>
<dt id="c.CALI_TYPE_TYPE">
<code class="descname">CALI_TYPE_TYPE</code><a class="headerlink" href="#c.CALI_TYPE_TYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="type">
<dt id="c.cali_attr_properties">
<code class="descname">cali_attr_properties</code><a class="headerlink" href="#c.cali_attr_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Attribute property flags. Attribute properties can be defined by
combining the following property flags using bitwise <code class="docutils literal"><span class="pre">or</span></code>:</p>
<dl class="macro">
<dt id="c.CALI_ATTR_DEFAULT">
<code class="descname">CALI_ATTR_DEFAULT</code><a class="headerlink" href="#c.CALI_ATTR_DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd><p>Default attribute flags. Selects <a class="reference internal" href="#c.CALI_ATTR_SCOPE_THREAD" title="CALI_ATTR_SCOPE_THREAD"><code class="xref c c-macro docutils literal"><span class="pre">CALI_ATTR_SCOPE_THREAD</span></code></a></p>
</dd></dl>

<dl class="macro">
<dt id="c.CALI_ATTR_ASVALUE">
<code class="descname">CALI_ATTR_ASVALUE</code><a class="headerlink" href="#c.CALI_ATTR_ASVALUE" title="Permalink to this definition">¶</a></dt>
<dd><p>By default, all attributes are stored in the generalized context
tree. Attributes with this flag will instead be stored
explicitly as <code class="docutils literal"><span class="pre">key:value</span></code> pairs on the blackboard and in
snapshot records.</p>
</dd></dl>

<dl class="macro">
<dt id="c.CALI_ATTR_NOMERGE">
<code class="descname">CALI_ATTR_NOMERGE</code><a class="headerlink" href="#c.CALI_ATTR_NOMERGE" title="Permalink to this definition">¶</a></dt>
<dd><p>By default, attributes are merged into a single generalized
context tree. Attributes with this flag will be placed in a tree
of their own.</p>
</dd></dl>

<dl class="macro">
<dt id="c.CALI_ATTR_SCOPE_PROCESS">
<code class="descname">CALI_ATTR_SCOPE_PROCESS</code><a class="headerlink" href="#c.CALI_ATTR_SCOPE_PROCESS" title="Permalink to this definition">¶</a></dt>
<dt id="c.CALI_ATTR_SCOPE_THREAD">
<code class="descname">CALI_ATTR_SCOPE_THREAD</code><a class="headerlink" href="#c.CALI_ATTR_SCOPE_THREAD" title="Permalink to this definition">¶</a></dt>
<dt id="c.CALI_ATTR_SCOPE_TASK">
<code class="descname">CALI_ATTR_SCOPE_TASK</code><a class="headerlink" href="#c.CALI_ATTR_SCOPE_TASK" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the scope of the attribute. These flags are mutually
exclusive.</p>
</dd></dl>

<dl class="macro">
<dt id="c.CALI_ATTR_SKIP_EVENTS">
<code class="descname">CALI_ATTR_SKIP_EVENTS</code><a class="headerlink" href="#c.CALI_ATTR_SKIP_EVENTS" title="Permalink to this definition">¶</a></dt>
<dd><p>Skip executing Caliper&#8217;s event callback functions when updating
this attribute.</p>
</dd></dl>

<dl class="macro">
<dt id="c.CALI_ATTR_HIDDEN">
<code class="descname">CALI_ATTR_HIDDEN</code><a class="headerlink" href="#c.CALI_ATTR_HIDDEN" title="Permalink to this definition">¶</a></dt>
<dd><p>Do not export this attribute into snapshot records.</p>
</dd></dl>

</dd></dl>

<dl class="type">
<dt id="c.cali_err">
<code class="descname">cali_err</code><a class="headerlink" href="#c.cali_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Error flag.</p>
<dl class="macro">
<dt id="c.CALI_SUCCESS">
<code class="descname">CALI_SUCCESS</code><a class="headerlink" href="#c.CALI_SUCCESS" title="Permalink to this definition">¶</a></dt>
<dd><p>Successful execution; no error.</p>
</dd></dl>

<dl class="macro">
<dt id="c.CALI_EINV">
<code class="descname">CALI_EINV</code><a class="headerlink" href="#c.CALI_EINV" title="Permalink to this definition">¶</a></dt>
<dd><p>Invalid function input parameter, e.g. providing an attribute ID
that does not exist.</p>
</dd></dl>

<dl class="macro">
<dt id="c.CALI_ETYPE">
<code class="descname">CALI_ETYPE</code><a class="headerlink" href="#c.CALI_ETYPE" title="Permalink to this definition">¶</a></dt>
<dd><p>Type mismatch, e.g. trying to assign an integer value to a
<a class="reference internal" href="#c.CALI_TYPE_STRING" title="CALI_TYPE_STRING"><code class="xref c c-macro docutils literal"><span class="pre">CALI_TYPE_STRING</span></code></a> attribute.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="c-annotation-api">
<h2>C++ annotation API<a class="headerlink" href="#c-annotation-api" title="Permalink to this headline">¶</a></h2>
<p>The <cite>cali::Annotation</cite> class provides the C++ instrumentation interface.</p>
<dl class="class">
<dt id="_CPPv2N4cali10AnnotationE">
<span id="cali::Annotation"></span><em class="property">class </em><code class="descclassname">cali::</code><code class="descname">Annotation</code><a class="headerlink" href="#_CPPv2N4cali10AnnotationE" title="Permalink to this definition">¶</a></dt>
<dd><p>#include &lt;Annotation.h&gt;</p>
<p>Instrumentation interface to add and manipulate context attributes</p>
<p>The Annotation class is the primary source-code instrumentation interface
for Caliper. Annotation objects provide access to named Caliper context
attributes. If the referenced attribute key does not exist yet, it will be
created automatically.</p>
<p>Example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">cali</span><span class="o">::</span><span class="n">Annotation</span> <span class="n">phase_ann</span><span class="p">(</span><span class="s">&quot;myprogram.phase&quot;</span><span class="p">);</span>

<span class="n">phase_ann</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="s">&quot;Initialization&quot;</span><span class="p">);</span>
  <span class="c1">// ...</span>
<span class="n">phase_ann</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<p>This example creates an annotation object for attributes with the
<code class="docutils literal"><span class="pre">myprogram.phase</span></code> key, and uses the <a class="reference internal" href="#_CPPv2N4cali10Annotation5beginEi" title="cali::Annotation::begin"><code class="xref cpp cpp-func docutils literal"><span class="pre">cali::Annotation::begin()</span></code></a> and
<a class="reference internal" href="#_CPPv2N4cali10Annotation3endEv" title="cali::Annotation::end"><code class="xref cpp cpp-func docutils literal"><span class="pre">cali::Annotation::end()</span></code></a> methods to mark a section of code where
that attribute is set to &#8220;Initialization&#8221;.</p>
<p>Note that the access to attributes through Annotation
objects is not exclusive: two different Annotation objects can reference and
update the same context attribute.</p>
<dl class="function">
<dt id="_CPPv2N4cali10Annotation10AnnotationEPKci">
<span id="cali::Annotation::Annotation__cCP.i"></span><code class="descclassname"></code><code class="descname">Annotation</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>name</em>, int <em>properties</em> = 0<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation10AnnotationEPKci" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor. Constructs an annotation object to manipulate
attributes. If no attribute key with the given name exists yet,
it will be created on the first invocation of a <code class="docutils literal"><span class="pre">begin</span></code> or
<code class="docutils literal"><span class="pre">set</span></code> call.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>const char* name</strong> &#8211; Attribute name.</li>
<li><strong>int properties</strong> &#8211; Properties given to the attribute when it is created. A combination of <a class="reference internal" href="#c.cali_attr_properties" title="cali_attr_properties"><code class="xref c c-type docutils literal"><span class="pre">cali_attr_properties</span></code></a> flags combined using a bitwise <code class="docutils literal"><span class="pre">or</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4cali10Annotation5beginEi">
<span id="cali::Annotation::begin__i"></span><a class="reference internal" href="#_CPPv2N4cali10AnnotationE" title="cali::Annotation">Annotation</a> &amp;<code class="descclassname"></code><code class="descname">begin</code><span class="sig-paren">(</span>int <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation5beginEi" title="Permalink to this definition">¶</a></dt>
<dt id="_CPPv2N4cali10Annotation5beginEd">
<span id="cali::Annotation::begin__double"></span><a class="reference internal" href="#_CPPv2N4cali10AnnotationE" title="cali::Annotation">Annotation</a> &amp;<code class="descclassname"></code><code class="descname">begin</code><span class="sig-paren">(</span>double <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation5beginEd" title="Permalink to this definition">¶</a></dt>
<dt id="_CPPv2N4cali10Annotation5beginEPKc">
<span id="cali::Annotation::begin__cCP"></span><a class="reference internal" href="#_CPPv2N4cali10AnnotationE" title="cali::Annotation">Annotation</a> &amp;<code class="descclassname"></code><code class="descname">begin</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation5beginEPKc" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new value for the referenced attribute to the blackboard.
If there is already a value for the referenced attribute on the
blackboard, the new value will be stacked on top.</p>
<p>Overloaded variants are provided for integer, floating point,
and string values. The value must match the type of the
referenced attribute key; e.g., string values can only be
assigned to attributes of type <a class="reference internal" href="#c.CALI_TYPE_STRING" title="CALI_TYPE_STRING"><code class="xref c c-macro docutils literal"><span class="pre">CALI_TYPE_STRING</span></code></a>.  The type
of a not-yet-existing attribute is defined by the first call to
<code class="docutils literal"><span class="pre">begin</span></code> or <code class="docutils literal"><span class="pre">set</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Reference to the Annotation object, which can be used to build a <cite>Guard</cite> scope guard object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4cali10Annotation5beginEv">
<span id="cali::Annotation::begin"></span><a class="reference internal" href="#_CPPv2N4cali10AnnotationE" title="cali::Annotation">Annotation</a> &amp;<code class="descclassname"></code><code class="descname">begin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation5beginEv" title="Permalink to this definition">¶</a></dt>
<dd><p>This &#8216;value-less&#8217; variant can be used for marking named code
regions without having to set a specific value. Internally, this
will create boolean-type attribute and set it to <code class="docutils literal"><span class="pre">true</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4cali10Annotation5beginE14cali_attr_typePv8uint64_t">
<span id="cali::Annotation::begin__cali_attr_type.voidP.uint64_t"></span><a class="reference internal" href="#_CPPv2N4cali10AnnotationE" title="cali::Annotation">Annotation</a> &amp;<code class="descclassname"></code><code class="descname">begin</code><span class="sig-paren">(</span>cali_attr_type <em>type</em>, void *<em>ptr</em>, uint64_t <em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation5beginE14cali_attr_typePv8uint64_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic version.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cali_attr_type type</strong> &#8211; Value datatype</li>
<li><strong>void* ptr</strong> &#8211; Address of value</li>
<li><strong>uint64_t size</strong> &#8211; Object size</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4cali10Annotation3setEi">
<span id="cali::Annotation::set__i"></span><a class="reference internal" href="#_CPPv2N4cali10AnnotationE" title="cali::Annotation">Annotation</a> &amp;<code class="descclassname"></code><code class="descname">set</code><span class="sig-paren">(</span>int <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation3setEi" title="Permalink to this definition">¶</a></dt>
<dt id="_CPPv2N4cali10Annotation3setEd">
<span id="cali::Annotation::set__double"></span><a class="reference internal" href="#_CPPv2N4cali10AnnotationE" title="cali::Annotation">Annotation</a> &amp;<code class="descclassname"></code><code class="descname">set</code><span class="sig-paren">(</span>double <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation3setEd" title="Permalink to this definition">¶</a></dt>
<dt id="_CPPv2N4cali10Annotation3setEPKc">
<span id="cali::Annotation::set__cCP"></span><a class="reference internal" href="#_CPPv2N4cali10AnnotationE" title="cali::Annotation">Annotation</a> &amp;<code class="descclassname"></code><code class="descname">set</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation3setEPKc" title="Permalink to this definition">¶</a></dt>
<dt id="_CPPv2N4cali10Annotation3setE14cali_attr_typePv8uint64_t">
<span id="cali::Annotation::set__cali_attr_type.voidP.uint64_t"></span><a class="reference internal" href="#_CPPv2N4cali10AnnotationE" title="cali::Annotation">Annotation</a> &amp;<code class="descclassname"></code><code class="descname">set</code><span class="sig-paren">(</span>cali_attr_type <em>type</em>, void *<em>ptr</em>, uint64_t <em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation3setE14cali_attr_typePv8uint64_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Set value for the referenced attribute on the blackboard.</p>
<p>Works like <a class="reference internal" href="#_CPPv2N4cali10Annotation5beginEi" title="cali::Annotation::begin"><code class="xref cpp cpp-func docutils literal"><span class="pre">cali::Annotation::begin()</span></code></a>, except instead
of stacking a new value on top of an existing one, <code class="docutils literal"><span class="pre">set</span></code>
overwrites the existing value.</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N4cali10Annotation3endEv">
<span id="cali::Annotation::end"></span>void <code class="descclassname"></code><code class="descname">end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N4cali10Annotation3endEv" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove top-most value of the referenced attribute from the blackboard.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="c-and-fortran-annotation-api">
<h2>C and Fortran annotation API<a class="headerlink" href="#c-and-fortran-annotation-api" title="Permalink to this headline">¶</a></h2>
<p>Like the C++ <code class="xref cpp cpp-class docutils literal"><span class="pre">Annotation</span></code> class, the C/Fortran API provides
<code class="docutils literal"><span class="pre">begin/set/end</span></code> functions to add, overwrite, and remove attribute
values from the blackboard.</p>
<p>The Fortran API is a thin wrapper around the C API. Fortran subroutine
names and semantics are identical to the respective C versions.</p>
<dl class="function">
<dt id="c.cali_create_attribute">
cali_id_t <code class="descname">cali_create_attribute</code><span class="sig-paren">(</span>const char*<em>&nbsp;name</em>, <a class="reference internal" href="#c.cali_attr_type" title="cali_attr_type">cali_attr_type</a><em>&nbsp;type</em>, int<em>&nbsp;properties</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_create_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an attribute key using the given name, type, and properties,
and return its ID. If an attribute with the given name already
exists, return its ID instead.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>char* name</strong> (<em>const</em>) &#8211; Attribute name</li>
<li><strong>type</strong> (<a class="reference internal" href="#c.cali_attr_type" title="cali_attr_type"><em>cali_attr_type</em></a>) &#8211; Attribute type</li>
<li><strong>properties</strong> (<em>int</em>) &#8211; Attribute properties. A combination of <a class="reference internal" href="#c.cali_attr_properties" title="cali_attr_properties"><code class="xref c c-type docutils literal"><span class="pre">cali_attr_properties</span></code></a> flags combined using a bitwise <code class="docutils literal"><span class="pre">or</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Attribute ID of the newly created attribute, or already existing attribute with the given name.</p>
</td>
</tr>
</tbody>
</table>
<p>Fortran signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">subroutine</span> <span class="n">cali_create_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>        <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span>  <span class="p">::</span> <span class="n">name</span>
  <span class="n">integer</span><span class="p">,</span>                 <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span>  <span class="p">::</span> <span class="nb">type</span>
  <span class="n">integer</span><span class="p">,</span>                 <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span>  <span class="p">::</span> <span class="n">properties</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">C_INT64_T</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="p">::</span> <span class="nb">id</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.cali_begin_double">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_begin_double</code><span class="sig-paren">(</span>cali_id_t<em>&nbsp;attr</em>, double<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_begin_double" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_begin_int">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_begin_int</code><span class="sig-paren">(</span>cali_id_t<em>&nbsp;attr</em>, int<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_begin_int" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_begin_string">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_begin_string</code><span class="sig-paren">(</span>cali_id_t<em>&nbsp;attr</em>, const char*<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_begin_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new value for attribute with the given ID to the blackboard.
If there is already a value for the referenced attribute on the
blackboard, the new value will be stacked on top.</p>
<p>Variants are provided for integer, floating point,
and string values. The value must match the type of the
referenced attribute key; e.g., string values can only be
assigned to attributes with type <code class="docutils literal"><span class="pre">CALI_TYPE_STRING</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>attr</strong> (<em>cali_id_t</em>) &#8211; Attribute ID</li>
<li><strong>val</strong> &#8211; Value</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Error flag. <code class="docutils literal"><span class="pre">CALI_SUCCESS</span></code> if no error.</p>
</td>
</tr>
</tbody>
</table>
<p>Fortran signatures:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">subroutine</span> <span class="n">cali_begin_string</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">C_INT64_T</span><span class="p">),</span>     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="nb">id</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>            <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_begin_int</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">C_INT64_T</span><span class="p">),</span>     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="nb">id</span>
  <span class="n">integer</span><span class="p">,</span>                     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_begin_double</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">C_INT64_T</span><span class="p">),</span>     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="nb">id</span>
  <span class="n">real</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span>                      <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.cali_begin">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_begin</code><span class="sig-paren">(</span>cali_id_t<em>&nbsp;attr</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>This &#8216;value-less&#8217; variant can be used for marking named code
regions without having to set a specific value. Internally, this
will set a boolean-type attribute to <code class="docutils literal"><span class="pre">true</span></code>.</p>
<p>Fortran signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">subroutine</span> <span class="n">cali_begin</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">C_INT64_T</span><span class="p">),</span>     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="nb">id</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.cali_set_double">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_set_double</code><span class="sig-paren">(</span>cali_id_t<em>&nbsp;attr</em>, double<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_set_double" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_set_int">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_set_int</code><span class="sig-paren">(</span>cali_id_t<em>&nbsp;attr</em>, int<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_set_int" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_set_string">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_set_string</code><span class="sig-paren">(</span>cali_id_t<em>&nbsp;attr</em>, const char*<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_set_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Set value for the referenced attribute on the blackboard.</p>
<p>These functions work like their corresponding <code class="docutils literal"><span class="pre">begin</span></code> variants,
except instead of stacking a new value on top of an existing one,
<code class="docutils literal"><span class="pre">set</span></code> overwrites the existing value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>attr</strong> (<em>cali_id_t</em>) &#8211; Attribute ID</li>
<li><strong>val</strong> &#8211; Value</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Error flag. <code class="docutils literal"><span class="pre">CALI_SUCCESS</span></code> if no error.</p>
</td>
</tr>
</tbody>
</table>
<p>Fortran signatures:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">subroutine</span> <span class="n">cali_set_string</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">C_INT64_T</span><span class="p">),</span>     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="nb">id</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>            <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_set_int</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">C_INT64_T</span><span class="p">),</span>     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="nb">id</span>
  <span class="n">integer</span><span class="p">,</span>                     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_set_double</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">C_INT64_T</span><span class="p">),</span>     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="nb">id</span>
  <span class="n">real</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span>                      <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.cali_set">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_set</code><span class="sig-paren">(</span>cali_id_t<em>&nbsp;attr</em>, const void*<em>&nbsp;ptr</em>, size_t<em>&nbsp;size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic version. This function allows setting values for attributes
with data types other than integer, string, or double; in
particular user-defined raw data (<cite>CALI_TYPE_USR</cite>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>attr</strong> (<em>cali_id_t</em>) &#8211; Attribute ID</li>
<li><strong>ptr</strong> (<em>void*</em>) &#8211; Address of value</li>
<li><strong>size</strong> (<em>size_t</em>) &#8211; Size of value in bytes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Error flag; <code class="docutils literal"><span class="pre">CALI_SUCCESS</span></code> if no error.</p>
</td>
</tr>
</tbody>
</table>
<p>This function is not yet implemented in Fortran.</p>
</dd></dl>

<dl class="function">
<dt id="c.cali_end">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_end</code><span class="sig-paren">(</span>cali_id_t<em>&nbsp;attr</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove top-most value of the referenced attribute from the blackboard.</p>
<p>Fortran signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">subroutine</span> <span class="n">cali_end</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">C_INT64_T</span><span class="p">),</span>     <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="nb">id</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.cali_begin_double_byname">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_begin_double_byname</code><span class="sig-paren">(</span>const char*<em>&nbsp;attr_name</em>, double<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_begin_double_byname" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_begin_int_byname">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_begin_int_byname</code><span class="sig-paren">(</span>const char*<em>&nbsp;attr_name</em>, int<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_begin_int_byname" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_begin_string_byname">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_begin_string_byname</code><span class="sig-paren">(</span>const char*<em>&nbsp;attr_name</em>, const char*<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_begin_string_byname" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_begin_byname">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_begin_byname</code><span class="sig-paren">(</span>const char*<em>&nbsp;attr_name</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_begin_byname" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_set_double_byname">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_set_double_byname</code><span class="sig-paren">(</span>const char*<em>&nbsp;attr_name</em>, double<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_set_double_byname" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_set_int_byname">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_set_int_byname</code><span class="sig-paren">(</span>const char* attr_name int<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_set_int_byname" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_set_string_byname">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_set_string_byname</code><span class="sig-paren">(</span>const char*<em>&nbsp;attr_name</em>, const char*<em>&nbsp;val</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_set_string_byname" title="Permalink to this definition">¶</a></dt>
<dt id="c.cali_end_byname">
<a class="reference internal" href="#c.cali_err" title="cali_err">cali_err</a> <code class="descname">cali_end_byname</code><span class="sig-paren">(</span>const char*<em>&nbsp;attr_name</em><span class="sig-paren">)</span><a class="headerlink" href="#c.cali_end_byname" title="Permalink to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal"><span class="pre">_byname</span></code> convenience functions reference attributes directly
through their name. If no attribute key with the given name exists
yet, it will be created. Thus, the following examples produce the
same result:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">cali_id_t</span> <span class="n">attr</span> <span class="o">=</span> <span class="n">cali_create_attribute</span><span class="p">(</span><span class="s">&quot;my.attribute&quot;</span><span class="p">,</span>
  <span class="n">CALI_TYPE_INT</span><span class="p">,</span> <span class="n">CALI_ATTR_DEFAULT</span><span class="p">);</span>

<span class="n">cali_set_int</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="mi">42</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-c"><div class="highlight"><pre><span class="n">cali_set_int_byname</span><span class="p">(</span><span class="s">&quot;my.attribute&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">);</span>
</pre></div>
</div>
<p>As the <code class="docutils literal"><span class="pre">_byname</span></code> variants do perform an extra string lookup, it
is better to use the by-ID lookup variants for performance-critical
sections.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>char* attr_name</strong> (<em>const</em>) &#8211; Attribute name</li>
<li><strong>val</strong> &#8211; Value</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Error flag. <code class="docutils literal"><span class="pre">CALI_SUCCESS</span></code> if no error.</p>
</td>
</tr>
</tbody>
</table>
<p>Fortran signatures:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">subroutine</span> <span class="n">cali_begin_string_byname</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">attr_name</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_begin_int_byname</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">attr_name</span>
  <span class="n">integer</span><span class="p">,</span>          <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_begin_double_byname</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">attr_name</span>
  <span class="n">real</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span>           <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_set_string_byname</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">attr_name</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_set_int_byname</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">attr_name</span>
  <span class="n">integer</span><span class="p">,</span>          <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_set_double_byname</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">attr_name</span>
  <span class="n">real</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span>           <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">val</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>

<span class="n">subroutine</span> <span class="n">cali_end_byname</span>
  <span class="n">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="n">intent</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span> <span class="p">::</span> <span class="n">attr_name</span>
  <span class="n">integer</span><span class="p">(</span><span class="n">kind</span><span class="p">(</span><span class="n">CALI_SUCCESS</span><span class="p">)),</span> <span class="n">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">optional</span> <span class="p">::</span> <span class="n">err</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>The following examples demonstrate basic Caliper source-code
annotations in C and Fortran. Similar to the C++ example in
<a class="reference internal" href="usage.html"><span class="doc">Getting started</span></a>, they mark <em>initialization</em> and <em>loop</em> phases in a
program, and export the main loop&#8217;s iteration counter in the
<em>iteration</em> attribute.</p>
<p>C:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;caliper/cali.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* Mark &quot;initialization&quot; phase */</span>
  <span class="n">cali_begin_byname</span><span class="p">(</span><span class="s">&quot;initialization&quot;</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
  <span class="n">cali_end_byname</span><span class="p">(</span><span class="s">&quot;initialization&quot;</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* Mark &quot;loop&quot; phase */</span>
    <span class="n">cali_begin_byname</span><span class="p">(</span><span class="s">&quot;loop&quot;</span><span class="p">);</span>

    <span class="cm">/* Create iteration counter attribute with CALI_ATTR_ASVALUE property */</span>
    <span class="kt">cali_id_t</span> <span class="n">iter_attr</span> <span class="o">=</span>
      <span class="n">cali_create_attribute</span><span class="p">(</span><span class="s">&quot;iteration&quot;</span><span class="p">,</span> <span class="n">CALI_TYPE_INT</span><span class="p">,</span> <span class="n">CALI_ATTR_ASVALUE</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="cm">/* Update iteration counter attribute */</span>
      <span class="n">cali_set_int</span><span class="p">(</span><span class="n">iter_attr</span><span class="p">,</span> <span class="n">loop</span><span class="p">);</span>

      <span class="cm">/* A Caliper snapshot taken at this point will contain</span>
<span class="cm">       * { &quot;loop&quot;, &quot;iteration&quot;=&lt;i&gt; }</span>
<span class="cm">       */</span>

      <span class="cm">/* perform computation */</span>
    <span class="p">}</span>

    <span class="cm">/* Clear the iteration counter attribute (otherwise, snapshots taken</span>
<span class="cm">     * after the loop will still contain the last iteration value)</span>
<span class="cm">     */</span>
    <span class="n">cali_end</span><span class="p">(</span><span class="n">iter_attr</span><span class="p">);</span>

    <span class="cm">/* End &quot;loop&quot; phase */</span>
    <span class="n">cali_end_byname</span><span class="p">(</span><span class="s">&quot;loop&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Fortran:</p>
<div class="highlight-default"><div class="highlight"><pre>program testf03
  use Caliper

  implicit none

  integer                    :: cali_ret
  integer(kind(CALI_INV_ID)) :: iter_attr
  integer                    :: i, count

  ! Mark &quot;initialization&quot; phase
  call cali_begin_byname(&#39;initialization&#39;)
  count = 4
  call cali_end_byname(&#39;initialization&#39;)

  if (count .gt. 0) then
     ! Mark &quot;loop&quot; phase
     call cali_begin_byname(&#39;loop&#39;)

     ! create attribute for iteration counter with CALI_ATTR_ASVALUE property
     call cali_create_attribute(&#39;iteration&#39;, CALI_TYPE_INT, &amp;
          CALI_ATTR_ASVALUE, iter_attr)

     do i = 1,count
        ! Update iteration counter attribute
        call cali_set_int(iter_attr, i)

        ! A Caliper snapshot taken at this point will contain
        ! { &quot;loop&quot;, &quot;iteration&quot;=&lt;i&gt; }

        ! perform calculation
     end do

     ! Clear the iteration counter attribute (otherwise, snapshots taken
     ! after the loop will still contain the last iteration value)
     call cali_end(iter_attr, cali_ret)

     ! Checking return value (not required, but good style)
     if (cali_ret .ne. CALI_SUCCESS) then
        print *, &quot;cali_end returned with&quot;, cali_ret
     end if

     ! End &quot;loop&quot; phase
     call cali_end_byname(&#39;loop&#39;)
  end if
end program testf03
</pre></div>
</div>
</div>
</div>
<div class="section" id="c-control-api">
<h2>C control API<a class="headerlink" href="#c-control-api" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt>
<code class="descname">void cali_push_snapshot(int scope, int n,                     const cali_id_t trigger_info_attr_list[],                     const void*     trigger_info_val_list[],                     const size_t    trigger_info_size_list[]);</code></dt>
<dd><p>This function triggers a snapshot and puts it into Caliper&#8217;s processing
queue. Optionally, users can provide a list of trigger (event) info
parameters to include in the snapshot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>scope</strong> &#8211; Indicates which scopes (process, thread, or task) the
snapshot should span.</li>
<li><strong>n</strong> &#8211; Number of optional trigger info entries.</li>
<li><strong>trigger_info_attr_list</strong> &#8211; Array of attribute IDs for the
trigger info entries.</li>
<li><strong>trigger_info_val_list</strong> &#8211; Array of pointers to values for the
trigger info entries.</li>
<li><strong>trigger_info_size_list</strong> &#8211; Array to sizes of the provided
trigger info values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The given trigger info (or event) attributes will be attached to
the generated snapshot, but not retained on the blackboard.</p>
<p>Example:</p>
</dd></dl>

<div class="highlight-c"><div class="highlight"><pre><span class="c1">// ...</span>

<span class="n">cali_begin_byname</span><span class="p">(</span><span class="s">&quot;push_snapshot_example&quot;</span><span class="p">);</span>

<span class="kt">cali_id_t</span> <span class="n">int_attr</span> <span class="o">=</span>
  <span class="n">cali_create_attribute</span><span class="p">(</span><span class="s">&quot;snapshot.intarg&quot;</span><span class="p">,</span> <span class="n">CALI_TYPE_INT</span><span class="p">,</span>
    <span class="n">CALI_ATTR_DEFAULT</span><span class="p">);</span>
<span class="kt">cali_id_t</span> <span class="n">str_attr</span> <span class="o">=</span>
  <span class="n">cali_create_attribute</span><span class="p">(</span><span class="s">&quot;snapshot.strarg&quot;</span><span class="p">,</span> <span class="n">CALI_TYPE_STRING</span><span class="p">,</span>
    <span class="n">CALI_ATTR_DEFAULT</span><span class="p">);</span>

<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">strval</span> <span class="o">=</span> <span class="s">&quot;MySnapshot&quot;</span><span class="p">;</span>
<span class="kt">int64_t</span>     <span class="n">intval</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>

<span class="kt">cali_id_t</span> <span class="n">trigger_attr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="n">int_attr</span><span class="p">,</span> <span class="n">str_attr</span> <span class="p">};</span>
<span class="kt">void</span><span class="o">*</span>     <span class="n">trigger_vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="o">&amp;</span><span class="n">intval</span><span class="p">,</span>  <span class="n">strval</span>   <span class="p">};</span>
<span class="kt">size_t</span>    <span class="n">trigger_size</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int64_t</span><span class="p">),</span>
                              <span class="n">strlen</span><span class="p">(</span><span class="n">strval</span><span class="p">)</span> <span class="p">};</span>

<span class="cm">/* Trigger snapshot with process and thread-local</span>
<span class="cm">   blackboard contents */</span>

<span class="n">cali_push_snapshot</span><span class="p">(</span><span class="n">CALI_SCOPE_THREAD</span> <span class="o">|</span> <span class="n">CALI_SCOPE_PROCESS</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">,</span> <span class="cm">/* number of trigger info attributes */</span><span class="p">,</span>
  <span class="n">trigger_attr</span><span class="p">,</span> <span class="n">trigger_val</span><span class="p">,</span> <span class="n">trigger_size</span><span class="p">);</span>

<span class="n">cali_end_byname</span><span class="p">(</span><span class="s">&quot;push_snapshot_example&quot;</span><span class="p">);</span>

<span class="c1">// ...</span>
</pre></div>
</div>
<p>This example program will generate a snapshot with (at least) the
following contents:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">push_snapshot_example</span><span class="o">=</span><span class="n">true</span><span class="p">,</span><span class="n">snapshot</span><span class="o">.</span><span class="n">intarg</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">snapshot</span><span class="o">.</span><span class="n">strarg</span><span class="o">=</span><span class="n">MySnapshot</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/caliper-logo-small.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Annotation API</a><ul>
<li><a class="reference internal" href="#constants-and-types">Constants and types</a></li>
<li><a class="reference internal" href="#c-annotation-api">C++ annotation API</a></li>
<li><a class="reference internal" href="#c-and-fortran-annotation-api">C and Fortran annotation API</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#c-control-api">C control API</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="concepts.html"
                        title="previous chapter">Concepts</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="link.html"
                        title="next chapter">Linking Caliper programs</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/api.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="link.html" title="Linking Caliper programs"
             >next</a> |</li>
        <li class="right" >
          <a href="concepts.html" title="Concepts"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Caliper 1.5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015-2016, Lawrence Livermore National Laboratory.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.
    </div>
  </body>
</html>